[gd_resource type="ShaderMaterial" load_steps=2 format=2]

[sub_resource type="Shader" id=1]
code = "shader_type spatial;
render_mode depth_test_disable, depth_draw_never, unshaded, cull_disabled;

uniform float offset : hint_range(0, 100);
uniform float encroach : hint_range(0, 1.0);

void fragment() {
    vec2 uv = UV;
    vec3 chroma;
    float amount = offset * 0.0005;
	
    uv *=  1.0 - uv.yx;
    float vig = uv.x*uv.y * 15.;
    vig = pow(vig, encroach);
    vig = 1.0 - vig;

    // cache screen
    vec3 og_color = textureLod( SCREEN_TEXTURE, SCREEN_UV, 0.0).rgb;

    // cache screen witch chroma (r/b shifted by amount)
    chroma.r = og_color.r;
    chroma.g = textureLod( SCREEN_TEXTURE, SCREEN_UV + vec2(amount * vig, 0.), 0.0).g;
    chroma.b = textureLod( SCREEN_TEXTURE, SCREEN_UV - vec2(amount * vig, 0.), 0.0).b;
 
    ALBEDO = chroma;
}"

[resource]
shader = SubResource( 1 )
shader_param/offset = 15.0
shader_param/encroach = 0.4
